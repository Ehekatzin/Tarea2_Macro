---
title: "Problema 2"
author: "Equipo 3"
date: "26/2/2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r include=FALSE}
library(readxl)
library(tseries)
library(cowplot)
library(car)
library(tinytex)
library(ggplot2)
library(lubridate)
library(reshape2)
library(gridExtra)
library(stargazer)
library(haven)
library(grid)
library(Matrix)
library(survival)
library(survey)
library(lattice)
library(Formula)
library(ggplot2)
library(Hmisc)
library(dplyr)
library(tidyverse)
library(tables)
library(car)
library(questionr)
library(srvyr)
library(texreg)
library(tinytex)
library(kableExtra)
library(knitr)

```



```{r eval=FALSE, include=FALSE}
.rs.restartR()   ##reiniciar R y borar elementos de la memoria
rm(list=ls())
```



## Problema 2: Inversión agregada en México.

Estudie los determinantes de la inversión agregada en México siguiendo
estos pasos: [3 horas, 0.5 puntos cada inciso]

  a) Obtenga, del INEGI, datos DESESTACIONALIZADOS para México
del consumo “$C$”, datos de “$I$”, la inversióm privada (inversión fija
bruta), y de "$Y$", el PIB, entre 1980 y 2018/III, A FRECUENCIA
TRIMESTRAL, EN TÉRMINOS REALES. (Si encuentra varias series pero ninguna cubre el periodo completo, tome una decisión ejecutiva para “unir” las series.)

  b) Grafique la relación entre $I$ y $Y$, es decir, grafique los puntos $(\%\Delta Y_t,\%\Delta I_t )$
poniendo la inversión en el eje la ordenadas.

  c) Calcule la volatilidad de las tres series de tasas de crecimiento $(\%\Delta Y_t,\%\Delta I_t )$ y explique cuál es más volatil.
  
 d)Obtenga, del banco de México, datos sobre las tasas de interés reales $(r^r)$ de la economía $r^r=r^n-\pi$, es decir, la tasa de interés nominal,
menos la tasa de inflación esperada (en cuyo caso se trata de la tasa
de interés real “ex-ante”), o menos la tasa de inflación observada (en
cuyo caso se trata de la “ex-post”).

  e) Estime una serie de modelos lineales con el objetivo de averiguar qué
variables predicen la tasa de crecimiento de la inversión $\% \Delta I_t$. Utilice
valores corrientes y rezagados del crecimiento en el producto, de la tasa de interés real, valores rezagados de la propia tasa de cambio en
la inversión y combinaciones de estas variables.

  f) Estime otra serie de modelos lineales con el objetivo de averiguar
qué variables predicen la tasa de crecimiento de la inversión $\% \Delta I_t$: a
las especificaciones del inciso anterior, agregue valores corrientes y/o
rezagados de la confianza empresarial del INEGI además de tambíen
estimar su efecto por si sólas.

  g) Interprete los resultados.
  
### Solucion.

### Inciso a)

```{r include=FALSE}
Datos <- read_excel("C:/Users/germa/OneDrive/Escritorio/Segundo Semestre/Macro 2/Tarea 2/datos.xlsx")

base_master <- read_excel("C:/Users/germa/OneDrive/Escritorio/Segundo Semestre/Macro 2/Tarea 2/base_inciso e_fred.xlsx")

```
Las series se obtuvieron del [Banco de Información Estadística (BIE)](https://www.inegi.org.mx/sistemas/bie/) del INEGI. En el caso del Producto Interno Bruto ("Producto Agregado") la serie se obtuvo de los indicadores económicos de coyuntura, esta serie se encuentra  en millones de pesos constantes a precios de 2013 y desestacionalizada. Además, es posible consultar la serie completa desde el primer trimestre de 1980 hasta el tercer trimestre de 2020, por lo cual no se requirió realizar manipulaciones sobre esta serie.

Las series de consumo privado (Consumo Agregado) y formación bruta de capital fijo (Inversión) se obtuvieron de las series de oferta y utilización total de bienes y servicios en dos partes. La primer parte se obtuvo desestacionalizada desde el primer trimestre de 1980 hasta el cuarto trimestre de 1993 en millones de pesos a precios de 1993; la segunda parte se obtuvo desestacionalizada desde el primer trimestre de 1993 hasta el tercer trimestre de 2020 en millones de pesos a precios constantes de 2013. Debido a que no existe una serie para el periodo completo, se optó por realizar el encadenamiento de las dos series antes mencionadas.

El encadenamiento de las series se realizó aprovechando el año 1993, ya que existen datos para este año en ambas series. De esta manera, se estimaron los datos para el periodo 1980-1992 de la siguiente manera:
$$ 
  X_{t}^{2013}=\left(\frac{X_t^{1993}}{X_{t+1}^{1993}}\right)X_{t+1}^{2013}
$$
En donde el superíndice representa el precio base de cada serie y le subíndice representa el periodo. De esta manera se utilizó la inversa de las tasas de crecimiento de la serie 1980-1993 para estimar el valor de los datos para ese periodo pero en precios constantes de 2013. En la siguiente tabla se presenta un resumen de las principales estadisticas descriptivas de las variables de Producto, Consumo e Inversión, para la serie completa nivel trimestral desde 1980 hasta 2020. 



```{r include=FALSE}
Fecha <- seq(as.Date("1980/1/1"), as.Date("2020/09/30"), by = "quarter")

```
```{r include=FALSE}
d_1 <- data.frame(cbind(Fecha, Datos$Y/1000, Datos$C/1000, Datos$I/1000))
names(d_1) = c("Periodo", "Producto", "Consumo", "Inversión")
d_1$Periodo <- seq(as.Date("1980/1/1"), as.Date("2020/09/30"), by = "quarter")
d_2 <- cbind(d_1[,-c(1)])
tabla1 <- summary(d_2)
```

```{r echo=FALSE}
knitr::kable(tabla1, format="latex", caption = "Resumen estadístico de la base de datos", position = "!h", label = "tab1")
```


```{r include=FALSE}
g1 <- melt(d_1, id.vars= "Periodo")

graph1 <- ggplot(g1, aes(x=Periodo, y=value, group=variable, color = variable , shape = variable)) +
  geom_line(aes(linetype=variable))+
  geom_point()+
  theme_classic()+
  xlab("")+
  ylab("MMDP de 2013")+
  scale_color_brewer(palette = "Set1")+
  theme_bw()

```

Ahora bien, en el siguiente gráfico podemos observar las series de tiempo correspondientes a las variables Producto, Consumo e Inversión. 

```{r  plot1, echo=FALSE, message=FALSE, warning=FALSE, fig.width=9, fig.cap="Series de tiempo Inversión Consumo y Producto 1980-2020 en MMDP de 2013", position = "!H", lable = "g1"}
print(graph1)
```

Las tres series presentan una tendencia alcista y parecen variar al unísono, sin embargo es el consumo la serie que sigue de forma mas fiel al producto. El gráfico también muestra que el Consumo es una proporción del Producto mucho mas grande que la Inversión. Otra característica importante que podemos observar es el hecho de que la proporción del producto que se destina a la inversión se ha reducido con el paso de los años mientras que la proporción del producto a consumo parece mantenerse constante. El gráfico aparenta que las fluctuaciones de la Inversión son mas bruscas en términos proporcionales que las otras dos series, es decir es posible visualizar que la Inversión es el componente mas volátil de la economía.  

Cabe destacar que, si bien nuestra intención era analizar el comportamiento de la Inversión privada (inversión fija bruta), decidimos utilizar la Formación Bruta de Capital, la cual incluye un componente tanto privado como público. Las razones por las cuales se tomó esta decisión se resumen en lo siguiente:

\begin{enumerate}
\item La inversión privada fija bruta sólo se encuentra disponible estadisticamente a partir de 1993 y por medio de un índice de inversión. Por su parte, la Formación bruta de capital ofrece datos a partir del inicio del periodo considerado por el presente estudio (1980) y se encuentra en sus valores originales y desestacionalizados. 
\item Se realizó el cálculo de la correlación entre estas dos variables en el periodo disponible de la inversión privada fija bruta (1993-2020) y se encuentra una correlación bastante alta, por lo cual el comportamiento en variaciones porcentuales y su incidencia en las regresiones lineales, no tendrá una alteración significativa. A continuación se expone el gráfico de dispersión mencionado. 
\end{enumerate}


```{r include=FALSE}
base_ifb <- read_excel("C:/Users/germa/OneDrive/Escritorio/Segundo Semestre/Macro 2/Tarea 2/base_ifb.xlsx")
```


```{r}
g_d <- ggplot(base_ifb, aes(fbc, ifb)) + geom_point(colour = "darkviolet", size = 3, alpha = 0.6) + theme_bw() + xlab("Formación bruta de capital")+
  ylab("Índice de inversión fija bruta") 
```


```{r  plot2, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.cap="Gráfico de dispersión entre las variables de Inversión", position = "!H", lable = "g2"}
print(g_d)
```

```{r include=FALSE}
library(MASS)
cor(x=base_ifb$fbc, y=base_ifb$ifb)
```
Tal como se puede apreciar en la gráfica anterior, el coeficiente de correlación entre estas dos variables es positivo y alto, específicamente la correlación lineal es de 0.9996. 


### Inciso b)

```{r include=FALSE}
d_4 <- data.frame(cbind(Fecha, base_master$dY*100, base_master$dI*100))
names(d_4) = c("Periodo", "Variación_Producto", "Variación_Inversión")
d_4$Periodo <- seq(as.Date("1980/1/1"), as.Date("2020/09/30"), by = "quarter")

g2 <- melt(d_4, id.vars= "Periodo")
graph2 <- ggplot(g2, aes(x=Periodo, y=value, group=variable, color = variable , shape = variable)) +
  geom_line(aes(linetype=variable))+
  geom_point()+
  theme_classic()+
  xlab("")+
  ylab("Variación %")+
  scale_color_brewer(palette = "Set2")+
  theme_bw()

```

En primer lugar, exponemos un gráfico temporal del comportamiento de las series de Producto e Inversión en términos de sus variaciones porcentuales, o de su crecimiento porcentual.  Se puede observar que el producto y la inversión tienden a variar de forma conjunta en la misma dirección sin embargo  esta ultima es considerablemente mas volátil que el producto sobre todo cuando se presentan recesiones, esto implica que caídas en el producto incluso pequeñas generan contracciones bruscas en la inversión. Otra observación importante es el hecho que si bien la inversión es siempre mas volátil que el producto, a partir de finales de los 90´s esta volatilidad ha ido disminuyendo, por lo que el gráfico refleja que la inversión ha sido una variable relativamente mas estable en las ultimas dos décadas con respecto al pasado. 


```{r plot3, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.cap="Variaciones porcentuales de Producto e Inversión", position = "!H", lable = "g3"}
print(graph2)
```


Posteriormente se procede a exponer un diagrama de dispersión entre la variación porcentual de la inversión y la variación porcentual del producto. Observando la concentración de puntos nos encontramos que la gran mayoría de las variaciones en la inversión oscilan entre -5% y 5%, mientras que la variación del producto entre -1% y 2%. El gráfico también revela una clara relación positiva y muy estrecha entre las variaciones porcentuales del producto e inversión, la escala de los ejes permite deducir que la pendiente de la recta ajustada es muy superior a uno por lo que a una variación porcentual del producto corresponde en promedio a una variación mas fuerte en la inversión. El coeficiente de correlación lineal entre estas dos variables es de 0.8652, valor que evidencia númericamente el alto grado de correlación lineal positiva entre la variación porcentual de la inversión y la variación porcentual del producto para México en el periodo de tiempo 1980-2020.  


```{r include=FALSE}
cor(x=na.omit(Datos$dI), y=na.omit(Datos$dY))
```


```{r include=FALSE}
cor(x=na.omit(base_master$dI), y=na.omit(base_master$dY))
```


```{r include=FALSE}
graph3 <- ggplot(d_4, aes(Variación_Producto, Variación_Inversión)) + geom_point(color = 'brown4',  size = 3, shape = 18, alpha = 0.5) + theme_bw() + xlab("Variación % Producto")+
  ylab("Variación % Inversión")+
  geom_smooth(method = "lm", se = FALSE)

```


```{r plot4, echo=FALSE, message=FALSE, warning=FALSE, fig.width=10, fig.cap="Diagrama de dispersión", position = "!H", lable = "g4"}
print(graph3)
```

### Inciso c)

Ahora bien, con el fin de estimar la volatilidad se realizaron calculos de la desviación estándar de los cambios porcentuales de las tres series. Estos resultados se presentan en la siguiente tabla: 

```{r eval=FALSE, include=FALSE}

sd(na.omit(base_master$dY))
sd(na.omit(base_master$dC))
sd(na.omit(base_master$dI))
```


\begin{table}[h]
\begin{center}
\begin{tabular}{| c | c |}
Variable & Desviación estándar\\ \hline
Cambio porcentual del Producto & 0.03873226  \\ 
Cambio porcentual del Consumo & 0.04182636 \\ 
Cambio porcentual de la Inversión & 0.1243083 \\ \hline
\end{tabular}
\caption{Volatilidad del cambio porcentual del Producto, Consumo e Inversión}
\label{tab:vo_c_y}
\end{center}
\end{table}


Los resultados en la tabla muestran que la volatilidad del consumo y producto son muy similares siendo la del consumo ligeramente superior, en cambio la volatilidad de la inversión es significativamente mas alta por lo que estas cifras confirman numéricamente lo que los gráficos anteriores han sugerido, la inversión es por mucho el componente mas volátil del producto, mientras que el consumo se muestra relativamente mas estable.


### Inciso d)

La tasa de interés real se construyó por los autores del presente estudio por medio de la siguiente ecuación: 
$$
r_t = i_t - \pi_t
$$
En donde $r_t$ es la tasa de interés real en cada periodo, $i_t$ es la tasa de interés nominal en términos temporales y $\pi_t$ es el valor de la inflación anual en cada periodo de tiempo considerado. Vale la pena recordar que la periodicidad del estudio es trimestral entre el primer trimestre de 1980 hasta el tercer trimestre del 2020. 

Para la construcción de la serie de interés real se tomaron la serie mensual de inflación a nivel anual del [Banco de Información Estadística (BIE)](https://www.inegi.org.mx/app/indicesdeprecios/Estructura.aspx?idEstructura=112001300030&T=%C3%8Dndices%20de%20Precios%20al%20Consumidor&ST=Inflaci%C3%B3n%20Mensual/) correspondiente al INEGI en la sección de Índices de Precios al Consumidor. Por su parte, para el interés nominal se tomaron dos fuentes dada la diferencia en disponibilidad de datos históricos: 

- Tasa de interés interbancaria (TIIE) procedente del [Sistema de Información Económica](https://www.banxico.org.mx/SieInternet/) del Banco de México. La tasa de interés que se tomó es la TIIE a 28 días. Esta serie de datos tiene información disponible a nivel mensual desde 1995 hasta 2020. Dado que que la serie es mensual, se estimó un valor trimestral por medio del promedio de cada trimestre correspondiente. 
- Tasas de interés de corto plazo en sus valores originales procedente de la [Federal Reserve Economic Data (FRED)](https://fred.stlouisfed.org/series/MEXLOCOSTORSTM) de St. Louis Fed. Esta serie cuenta con datos a nivel mensual del tipo de interés nominal, por lo cual se procedió a realizar los calculos trimestrales a través de promedios en los trimestres correspondientes. Así mismo, su serie dispone de datos en el periodo completo que se maneja en el presente estudio (1980-2020), lo que lo diferencia de la primer serie, y es la razón por la cual se incorpora. 

A continuación se expone el comportamiento de las dos series de tipo de interés real que se estimaron por medio de los siguientes dos gráficos. 

```{r}
base_e_tiie <- read_excel("C:/Users/germa/OneDrive/Escritorio/Segundo Semestre/Macro 2/Tarea 2/base_inciso e_tiie.xlsx")

base_e_fred <- read_excel("C:/Users/germa/OneDrive/Escritorio/Segundo Semestre/Macro 2/Tarea 2/base_inciso e_fred.xlsx")
```


```{r}
Fecha2 <- seq(as.Date("1995/1/1"), as.Date("2020/09/30"), by = "quarter")

d_5 <- data.frame(cbind(Fecha2, base_e_tiie$r_tiie))
names(d_5) = c("Periodo", "r (Banxico)")
d_5$Periodo <- seq(as.Date("1995/1/1"), as.Date("2020/09/30"), by = "quarter")

g5 <- melt(d_5, id.vars= "Periodo")

graph5 <- ggplot(g5, aes(x=Periodo, y=value, group=variable, color = variable , shape = variable)) +
  geom_line(aes(linetype=variable))+
  geom_point(size = 2)+
  theme_classic()+
  xlab("")+
  ylab("Tasa de interés real (%)")+
  scale_color_brewer(palette = "Set2")+
  theme_bw()

```

```{r plot5, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.cap="Tasa de interés real 1995-2020 con datos de Banxico", position = "!H", lable = "g5"}
print(graph5)
```


En el gráfico del comportamiento del tipo de interés real con los datos del Banco de México (Banxico) se observa un pico bastante alto a inicios de 1995, que refleja parte de las consecuencias de la crisis económica que sufrió México a partir de 1994. El tipo de interés alcanza un nivel superior al 70% pero rapidamente desciende en los siguiente dos semestres hasta tocar valores negativos cercanos a 0. Posteriormente se refleja una serie de fluctuaciones con un nuevo pico (pero mucho menor que al anterior) de 18% en el tercer trimestre de 1998, y luego el comportamiento de la serie se estabiliza en valores del tipo de interés real menores al 11%, con algunos trimestres, aunque pocos, con valores negativos pero aún así, muy cercanos al 0%.   


```{r}
d_6 <- data.frame(cbind(Fecha, base_e_fred$r_fred))
names(d_6) = c("Periodo", "r (Fred)")
d_6$Periodo <- seq(as.Date("1980/1/1"), as.Date("2020/09/30"), by = "quarter")

g6 <- melt(d_6, id.vars= "Periodo")

graph6 <- ggplot(g6, aes(x=Periodo, y=value, group=variable, color = variable , shape = variable)) +
  geom_line(aes(linetype=variable))+
  geom_point()+
  theme_classic()+
  xlab("")+
  ylab("Tasa de interés real (%)")+
  scale_color_brewer(palette = "Set1")+
  theme_bw()
```


```{r plot6, echo=FALSE, message=FALSE, warning=FALSE, fig.width=12, fig.cap="Tasa de interés real 1980-2020 con datos de FRED", position = "!H", lable = "g6"}
print(graph6)
```

Por su parte, en el gráfico del tipo de interés con los datos de tipo de interés nominal de la FRED, observamos en primer lugar que si nos concentramos en la serie desde 1995 hasta 2020, el comportamiento de la serie es muy similar a la de la serie anterior que se construyó con los datos de la TIIE del Banxico, por lo que no hay diferencia sustancial en las dos series durante el periodo 1995-2020. Esto se comprueba númericamente con un coeficiente de correlación lineal de 0.91. 

Por otra parte, en el periodo 1980-1995 se observan grandes oscilaciones en la serie, con valores negativos muy altos, como ocurre en el primer trimestre de 1983 (-59%) y en particular en el segundo trimestre de 1988 (-85%). Esto es consecuencia de periodos inflacionarios muy altos en estos puntos en el tiempo de la economía mexicana. 


### Inciso e)

En esta sección se realizará una aproximación a los determinantes de la inversión, realizando regresiones lineales mediante el método de Mínimos Cuadrados Ordinarios (MCO). Se tomará la variación porcentual de la inversión como variable a explicar, y con respecto a las variables explicativas o independientes se utilizarán la variación del producto, su rezago, la tasa de interés real, su variación porcentual y su variación rezagada un periodo. Así mismo, se utilizará el rezago de un periodo de la misma variable dependiente (crecimiento porcentual de la inversión).

Dado que se cuenta con dos series de tipo de interés real, una para el periodo 1980-2020 y otra para 1995-2020, se construirán 6 modelos econométricos para cada serie temporal. Es decir, en total en esta sección se presentarán 12 modelos, los primeros seis con el periodo 1980-2020 y los otros seis con el periodo 1995-2020. Es importante tener en cuenta que la periodicidad de las observaciones es de forma trimestral. Los 6 primeros modelos son similares a los 6 ultimos, la unica diferencia es el periodo temporal, y el origen de la serie del tipo de interés real, por lo demás, los valores y las variables son las mismas.

En las siguientes dos tablas se presentarán los primeros 6 modelos, los cuales se diferencian entre sí por la agregación de variables adicionales. En la medida en que se desplaza del modelo 1 al modelo 6, se agregan nuevas variables explicativas. 

```{r}

reg1 <- lm(dI ~ r_tiie, data=base_e_tiie)

reg2 <- lm(dI ~ dr_tiie, data=base_e_tiie)

reg3 <- lm(dI ~ dr_tiie + dY, data=base_e_tiie)

reg4 <- lm(dI ~ r_tiie + dr_tiie + dY + lag(dY), data=base_e_tiie)

reg5 <- lm(dI ~ r_tiie + dr_tiie + lag(dY) + lag(dI), data=base_e_tiie)

reg6 <- lm(dI ~ r_tiie + dr_tiie + dY + lag(dI) + lag(dr_tiie), data=base_e_tiie)


```


```{r include=FALSE}
print(reg6)
```



```{r regresion1, results = 'asis', echo = FALSE, message=FALSE, warning=FALSE}
stargazer(reg1, reg2, reg3, 
          title= "Factores determinantes de la inversión en el periodo 1995-2020",
          header = FALSE,
          dep.var.caption = "Variable Dependiente",
          dep.var.labels = c("Variación Inversión (I)"),
          covariate.labels =  c("Tasa interés real (r)", "Variación r", "Variación Producto (Y)"),
          type="latex",
          column.labels = c("Modelo 1", "Modelo 2", "Modelo 3"),
          single.row = TRUE,
          table.placement = "!htbp")
```

En los dos primeros modelos para 1995-2020, se observa que la tasa de interés real no presenta un efecto significativo, lo cual sigue siendo consistente para los siguientes tres modelos (modelos 4, 5 y 6 en la tabla posterior) puesto que bajo ninguna especificación el tipo de interés real en su valor original presenta efectos significativos para explicar el comportamiento de la variación de la inversión. Esto se puede justificar en el sentido de que se está estimando modelos básicos por medio de Mínimos Cuadrados Ordinarios, y se necesitaría de modelos temporales más avanzados, que incluyan la estacionariedad de las series y soporten la existencia de *outliers*. 

Sin embargo, se destaca que en el modelo 3, el efecto de la variación del tipo de interés si presenta un signo negativo (esperado) y significativo. Este efecto se genera en el modelo en el que además de las variables de interés, se le adiciona el comportamiento de la variación del producto, el cual eleva el poder explicativo del modelo de gran forma, pasando de un $R^2$ casi nulo a un $R^2$ del 0.80. Esto da clara intuición del fuerte efecto que tiene el crecimiento del producto en el crecimiento de la inversión.  

Lo anterior se justifica con el hecho de que el efecto de la variación del Producto sobre la Inversión es positivo y fuerte (como era de esperarse), incrementos del 1% en el producto, estimulan la inversión en un 2.19%. Lo que indica la posible existencia de efectos derrame de gran forma por parte del crecimiento económico sobre la confianza inversionista y sobre la atracción de la inversión tanto nacional como extranjera. 

```{r regresion2, results = 'asis', echo = FALSE, message=FALSE, warning=FALSE}
stargazer(reg4, reg5, reg6, 
          title= "Continuación: Factores determinantes de la inversión en el periodo 1995-2020",
          header = FALSE,
          dep.var.caption = "Variable Dependiente",
          dep.var.labels = c("Variación Inversión (I)"),
          covariate.labels =  c("Tasa interés real (r)", "Variación de r", "Variación Producto (Y)", "Rezago variación Y", "Rezago variación I", "Rezago variación de r"),
          type="latex",
          column.labels = c("Modelo 4", "Modelo 5", "Modelo 6"),
          single.row = TRUE, 
          table.placement = "!htbp")
```

 
En la siguiente tabla se presentan los siguientes tres modelos (modelos 4, 5 y 6) del periodo 1995-2020. 

En los modelos 4 y 6, se destaca el efecto negativo y significativo de la variación del tipo de interés real sobre el crecimiento de la inversión en terminos porcentuales. Si bien, el interés real no es significativo, su variación si lo es, y presenta el efecto esperado. Sin embargo, el efecto no es grande. En el caso específico del modelo 4 y 6 se refleja que incrementos del 10% del tipo de interés reducen la inversión en un 0.05% y 0.04% respectivamente. 

Por su parte, el efecto de la variación del producto sigue siendo positivo y fuerte, lo que indica robustez en su efecto, puesto que el coeficiente de impacto es similar en todas las 6 especificaciones de los modelos. Con esto, se comprueban los efectos derrames del crecimiento económico sobre el crecimiento de la inversión, que fue mencionado en párrafos anteriores. Sin embargo, el rezago de la variación del Producto al parecer no registra efectos significativos claros (véase modelos 4 y 5). 


A pesar de lo anterior, el comportamiento rezagado de la inversión registra efectos positivos y relativamente fuertes, lo que da la intuición de que las variaciones positivas pasadas de la inversión explican parte del crecimiento positivo de la inversión del presente. Esto indica el hecho de que el conjunto de inversión del pasado atrae más inversión en el futuro. Especificamente, incrementos en un 10% de la inversión en el periodo pasado, genera incrementos entre el 3.9% y el 9.2% en la inversión presente (veáse modelos 6 y 5 respectivamente).



```{r}

reg7 <- lm(dI ~ r_fred, data=base_e_fred)

reg8 <- lm(dI ~ dr_fred, data=base_e_fred)

reg9 <- lm(dI ~ r_fred + dY, data=base_e_fred)

reg10 <- lm(dI ~ r_fred + dY + lag(dY), data=base_e_fred)

reg11 <- lm(dI ~ r_fred + dr_fred + dY + lag(dI), data=base_e_fred)

reg12 <- lm(dI ~ r_fred + lag(dY) + lag(dI) + lag(dr_fred), data=base_e_fred)


```


Ahora bien, en las siguientes dos tablas se presentarán los resultados de las 6 regresiones realizadas durante el periodo 1980-2020, serie temporal se destaca por tener fuertes y mayores oscilaciones del tipo de interés real durante la década del 80. Recordemos que en esta serie el tipo de interés real fue construido con el tipo de interés nominal de corto plazo de México, datos que fueron capturados por las estadisticas de la "Federal Reserve Bank of St.Louis", por lo que este tipo de interés real presenta algunas diferencias con respecto al tipo de interés con el que se realizaron las regresiones presentadas en las dos anteriores gráficas (periodo 1995-2020). 


```{r regresion3, results = 'asis', echo = FALSE, message=FALSE, warning=FALSE}
stargazer(reg7, reg8, reg9, 
          title= "Factores determinantes de la inversión en el periodo 1980-2020",
          header = FALSE,
          dep.var.caption = "Variable Dependiente",
          dep.var.labels = c("Variación Inversión (I)"),
          covariate.labels =  c("Tasa interés real (r) de la FRED", "Variación r", "Variación Producto (Y)"),
          type="latex",
          column.labels = c("Modelo 1", "Modelo 2", "Modelo 3"),
          single.row = TRUE,
          table.placement = "!htbp")
```

En el primer y segundo modelo se encuentra un efecto interesante, al tener la tasa de interés real, en su valor original y en términos de variación, un impacto positivo, aunque marginalmente pequeño con respecto a la variación de la Inversión. No obstante, estos dos modelos tienen una capacidad predictiva mínima con un $R^2$ menor a 0.05, es decir que tan solo explican menos del 4% del comportamiento de la variación de la inversión. Este cambio de signo (con respecto al esperado) puede ser causado por la presencia de no estacionariedad en la serie y la existencia de una gran cantidad de *outliers* en la serie de interés real, tal como se mencionó anteriormente. Esto es consecuente con el hecho de que el efecto significativo y positivo del tipo de interés se desvanece al incrementar la capacidad predictiva del modelo al incorporar la variable correspondiente a la variación del Producto (el $R^2$ se incrementa a 0.75). En este caso, para el modelo 3, el efecto del crecimiento del Producto es más fuerte que en el caso de los resultados del periodo 1995-2020, puesto que el coeficiente supera el valor de 2.7, por lo que incrementos en un 1% del crecimiento económico generan crecimientos cercanos al 2.7% en la inversión.  

```{r regresion4, results = 'asis', echo = FALSE, message=FALSE, warning=FALSE}
stargazer(reg10, reg11, reg12, 
          title= "Continuación: Factores determinantes de la inversión en el periodo 1980-2020",
          header = FALSE,
          dep.var.caption = "Variable Dependiente",
          dep.var.labels = c("Variación Inversión (I)"),
          covariate.labels =  c("Tasa interés real (r) de la FRED", "Variación r", "Variación Producto (Y)", "Rezago Variación Y", "Rezago Variación I", "Rezago Variación r"),
          type="latex",
          column.labels = c("Modelo 4", "Modelo 5", "Modelo 6"),
          single.row = TRUE,
          table.placement = "!htbp")
```

Por otra parte, en los modelos 4, 5 y 6, el efecto positivo del tipo de interés que se presentaban en los modelos 1 y 2 se desvanece por la misma razón comentada anteriormente para el modelo 3. El efecto significativo del tipo de interés real no es robusto y ante la incorporación de nuevas variables y del aumento de la capacidad predictiva del modelo, su efecto significativo desparece. En general, el tipo de interés no parece presentar efectos significativos sobre la variación de la inversión. 

Se destaca igualmente que la variación del Producto continua siendo robusta, y en especial obtiene su mayor valor en coeficiente (2.77) en el modelo 4. Así mismo, de manera similar a lo que ocurrió en las estimaciones del periodo 1995-2020, el rezago de la variación del Producto no presenta efectos significativos en ninguna especificación presentada. 

Por ultimo, el rezago de la variación de la inversión continua generando efectos positivos en todas las especificaciones estudiadas, por lo que el crecimiento de la inversión atrae más inversión en el futuro cercano, y ante esto, la misma inversión genera un impacto importante sobre las futuras inversiones. Este resultado es analógo a lo que ocurrió en las estimaciones iniciales del periodo 1995-2020. 


### Inciso f)

En esta sección, se toman parte de los modelos econometricos presentados en la sección anterior, con la diferencia de que se estima para el periodo a nivel trimestral desde 2004 hasta 2020, dado que la intención de este apartado es incorporar una variable de confianza empresarial, estimada por el INEGI desde el año 2004. De esta forma, se estiman 6 modelos diferentes, partiendo de la confianza empresarial y de su variación, con el fin de explicar el comportamiento de la variación de la Inversión. En la medida en que se avanza en los modelos se irán adicionando variables explicativas adicionales. En las siguientes dos tablas se presentan dichos resultados.

```{r}
base_f <- read_excel("C:/Users/germa/OneDrive/Escritorio/Segundo Semestre/Macro 2/Tarea 2/base_inciso f.xlsx")
```

```{r}
reg13 <- lm(dI ~ CE, data=base_f)

reg14 <- lm(dI ~ DCE, data=base_f)

reg15 <- lm(dI ~ CE  + dY, data=base_f)

reg16 <- lm(dI ~ CE + DCE + dY + dr + lag(dI), data=base_f)

reg17 <- lm(dI ~ CE  + lag(dY) + dr + lag(dI), data=base_f)

reg18 <- lm(dI ~ DCE + dY + dr + lag(dI), data=base_f)

```

```{r regresion5, results = 'asis', echo = FALSE, message=FALSE, warning=FALSE}
stargazer(reg13, reg14, reg15, 
          title= "Factores determinantes de la inversión en el periodo 2004-2020",
          header = FALSE,
          dep.var.caption = "Variable Dependiente",
          dep.var.labels = c("Variación Inversión (I)"),
          covariate.labels =  c("Confianza empresarial (CF)", "Variación CF", "Variación Producto (Y)"),
          type="latex",
          column.labels = c("Modelo 1", "Modelo 2", "Modelo 3"),
          single.row = TRUE,
          table.placement = "!htbp")
```

En el modelo 1 y 2 se puede apreciar que la confianza empresarial, tanto en su valor original como su variación, afecta positivamente al comportamiento de la inversión, y en el caso especifico de la primer variable, esta por si sola explica el 49.1% de la variabilidad de la inversión. Dicho signo positivo y significativo de la confianza empresarial se ratifica en el modelo 5 (veáse tabla posterior). 

Por otro lado, la variación del producto, al igual que en todos los modelos anteriores, continua afectando de forma positiva a la variación de la inversión, confirmando la existencia un efecto derrame considerable del crecimiento económico sobre las decisiones de inversión de los empresarios. Así mismo, la variación del tipo de interés real en los modelos 4 y 6 presentan un efecto negativo (esperado), a un nivel similar del revelado en modelos anteriores. Por lo cual, si bien el tipo de interés real no reporta efectos significativos, la variación de su valor si lo hace, y es robusto para dos de los tres modelos con confianza empresarial que tomaron esta variable. 


Finalmente, se ratifica otra de las intuiciones encontradas en los modelos de la sección anterior. El rezago de la variación de la inversión continua teniendo un efecto positivo, por lo que sin importar la especificación y las variables adicionales que se consideren, al igual que indiferentemente del periodo de tiempo, la inversión crea más inversión. Por tanto, el crecimiento de la inversión en periodo anterior tiene un efecto positivo en el crecimiento de la inversión en el periodo actual. Si se considera el modelo 6, se destaca que su capacidad de explicación es del 87%, medida del $R^2$.


```{r regresion6, results = 'asis', echo = FALSE, message=FALSE, warning=FALSE}
stargazer(reg16, reg17, reg18, 
          title= "Continuación: Factores determinantes de la inversión en el periodo 2004-2020",
          header = FALSE,
          dep.var.caption = "Variable Dependiente",
          dep.var.labels = c("Variación Inversión (I)"),
          covariate.labels =  c("Confianza empresarial (CE)", "Variación CE", "Variación Producto (Y)", "Rezago Variación Y", "Variación Interés real", "Rezago Variación I"),
          type="latex",
          column.labels = c("Modelo 4", "Modelo 5", "Modelo 6"),
          single.row = TRUE,
          table.placement = "!htbp")
```


### Inciso g) 

La interpretación de resultados se encuenta detalladamente en los párrafos de las secciones anteriores. Por lo cual, se dedicará esta sección a presentar un resumen de los princpales resultados, los cuales se exponen a continuación: 

- El crecimiento económico medido por la variación del Producto genera efectos derrame sobre la inversión de manera profunda, en el sentido en el que el crecimiento económico causa expectativas sobre desarrollos de los mercados e incrementos del empleo y de los ingresos, lo cual tiende a motivar la formación de inversión en la economía mexicana. Esto se demuestra con un efecto positivo y grande en todos los periodos de tiempo y en las especificaciones consideradas. 

- El tipo de interés real en su valor original no parece tener efectos significativos en ningún periodo de tiempo y en ninguna especificación de los modelos econométricos que se estimaron. 

- En algunas especificaciones, la variación del tipo de interés real si presenta un signo significativo y negativo sobre el comportamiento de la inversión. Este efecto parece ser robusto, en especial para los modelos en donde se estudió la confianza empresarial (sección f). 

- El rezago de la variación de la Inversión es robusto en todos los modelos estimados, y por ende, se puede intuir que la inversión genera más inversión en la economía mexicana, es decir, que el crecimiento de la inversión en un periodo pasado, produce incrementos en el crecimiento de la inversión en el presente. Por tanto, el crecimiento de la inversión por sí sola puede desencadenar estimulos posteriores en la inversión, probablemente mediante el reconocimiento de un mejor escenario para la inversión.  

- El índice de confianza empresarial afecta positivamente a la variación de la inversión, y por si sola, en uno de los modelos estimados, explica al menos el comportamiento del 49% de la variación de la inversión, por lo cual se puede pensar que el papel de las expectativas juega un papel relevante en la economía mexicana. 


